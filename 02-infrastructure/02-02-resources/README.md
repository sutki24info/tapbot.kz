---
title: 02.02 - Ресурсы и производительность
---

**Последнее обновление:** 13 июля 2025\
**Ответственный:** DevOps команда\
**Статус:** Актуальные конфигурации в продакшене

## Обзор архитектуры

### Принцип разделения ролей

-  **Первый сервер (93.189.229.59):** Автоматизация и кэширование (n8n + Redis + мониторинг)
-  **Второй сервер (178.236.17.186):** Базы данных и хранение (PostgreSQL + Directus + Qdrant)

### Провайдер услуг

-  **Компания:** beget.com (Россия)
-  **Дата-центр:** Москва
-  **Преимущества:** Низкая стоимость, русскоязычная поддержка, стабильность
-  **Особенности:** Оплата в рублях, российская юрисдикция

## 02\.02.01 - CPU и вычислительная мощность

### Первый сервер - n8n Автоматизация (93.189.229.59)

#### Текущая конфигурация:

```
CPU: 2 ядра Standard 3+ ГГц
Архитектура: x86_64
Поддержка виртуализации: KVM
Базовая частота: 3.0+ ГГц
```

#### Планируемая нагрузка:

```
n8n workflows:          ~25% CPU, пиковая: 40%
Redis cache:            ~10% CPU, пиковая: 15%  
Traefik proxy:          ~5% CPU, пиковая: 10%
Portainer GUI:          ~5% CPU, пиковая: 8%
Система + мониторинг:   ~10% CPU, пиковая: 15%
ИТОГО:                  ~55% CPU, пиковый: 88%
```

#### Критерии upgrade CPU:

-  Usage >90% более 1 часа подряд
-  Увеличение времени ответа API >2 секунд
-  Очереди задач в n8n >100 элементов
-  Жалобы пользователей на медленную работу

### Второй сервер - Базы данных (178.236.17.186)

#### Текущая конфигурация:

```
CPU: 2 ядра Standard 3+ ГГц
Архитектура: x86_64
Поддержка виртуализации: KVM
Базовая частота: 3.0+ ГГц
```

#### Планируемая нагрузка:

```
PostgreSQL:             ~30% CPU, пиковая: 50%
Directus CMS:           ~20% CPU, пиковая: 35%
Qdrant (планируется):   ~15% CPU, пиковая: 25%
Webmin:                 ~5% CPU, пиковая: 8%
Система + мониторинг:   ~10% CPU, пиковая: 15%
ИТОГО:                  ~80% CPU, пиковый: 133%
```

#### ⚠️ Потенциальное узкое место:

Второй сервер может потребовать upgrade CPU при полной нагрузке от всех планируемых сервисов.

## 02\.02.02 - Память и хранилище

### Первый сервер - Память

#### Текущая конфигурация:

```
RAM: 4GB DDR4
Swap: Не настроен (рекомендуется 2GB)
```

#### Планируемое потребление памяти:

```
n8n workflows:          ~1.5GB RAM
Redis cache:            ~512MB RAM  
Traefik proxy:          ~256MB RAM
Portainer GUI:          ~128MB RAM
Система Ubuntu:         ~400MB RAM
Буферы/кэш ОС:          ~500MB RAM
ИТОГО:                  ~3.3GB RAM (82% от 4GB)
```

#### Критерии upgrade RAM:

-  Usage >85% более 24 часов подряд
-  Частые swap операции
-  Деградация производительности приложений
-  Планируемое добавление новых сервисов

### Второй сервер - Память

#### Текущая конфигурация:

```
RAM: 4GB DDR4
Swap: Не настроен (рекомендуется 2GB)
```

#### Планируемое потребление памяти:

```
PostgreSQL:             ~1.2GB RAM (рабочий набор)
Directus CMS:           ~800MB RAM
Qdrant (планируется):   ~1GB RAM (векторы в памяти)
Webmin:                 ~50MB RAM
PgAdmin:                ~100MB RAM
Система Ubuntu:         ~400MB RAM
Буферы/кэш ОС:          ~450MB RAM
ИТОГО:                  ~4GB RAM (100% от 4GB)
```

#### ⚠️ Критическое узкое место:

Второй сервер **ОБЯЗАТЕЛЬНО** потребует upgrade до 8GB RAM при установке Qdrant.

### Хранилище

#### Первый сервер:

```
Диск: 10GB NVMe SSD
Тип: High-performance NVMe
IOPS: ~10,000+
Текущее использование: ~2GB
Планируемое: ~6GB (логи, конфигурации, Redis persistence)
```

#### Второй сервер:

```
Диск: 30GB NVMe SSD  
Тип: High-performance NVMe
IOPS: ~10,000+
Текущее использование: ~8GB
Планируемое: ~20GB (PostgreSQL + векторная база Qdrant)
```

## 02\.02.03 - Сетевая пропускная способность

### Общие характеристики

#### Внешний канал:

```
Скорость: 250 Мбит/с
Неограниченный трафик
Географическое расположение: Москва
Ping до Казахстана: ~40-60ms
Ping до Европы: ~30-50ms
```

#### Планируемая нагрузка:

```
Telegram Bot API:       ~10-50 запросов/сек
Directus API:          ~5-20 запросов/сек
PostgreSQL репликация: При настройке бэкапов
Static files:          Минимально (через CDN в будущем)

Пиковая нагрузка:      ~10-20 Мбит/с (4-8% от канала)
```

### Межсерверная связь

#### Особенности beget.com:

-  Серверы в одном дата-центре
-  Внутренняя сеть: гигабитная
-  Межсерверный трафик: не тарифицируется
-  Латентность между серверами: \<1ms

## 02\.02.04 - Мониторинг и метрики

### Критические метрики для отслеживания

#### Система алертов:

```
CPU Usage:          >80% - требует внимания, >90% - критично
RAM Usage:          >85% - требует внимания, >95% - критично  
Disk Usage:         >80% - требует внимания, >90% - критично
Network I/O:        Мониторинг трендов роста
Disk I/O:          >80% capacity - узкое место
```

#### Текущие инструменты:

-  **htop** - интерактивный мониторинг ресурсов
-  **docker stats** - потребление ресурсов контейнерами
-  **df -h** - использование дискового пространства
-  **free -h** - использование памяти

#### Планируемые инструменты:

-  **Prometheus + Grafana** - сбор метрик и дашборды
-  **Node Exporter** - системные метрики для Prometheus
-  **Telegram алерты** - уведомления при превышении лимитов

### Процедуры при достижении лимитов

#### CPU >90%:

1. Идентификация процесса-потребителя через `htop`
2. Оптимизация приложений (индексы БД, кэширование)
3. Upgrade сервера при постоянной высокой нагрузке

#### RAM >95%:

1. Перезапуск сервисов для освобождения memory leaks
2. Настройка swap если не настроен
3. Добавление RAM при стабильно высоком потреблении

#### Disk >90%:

1. Очистка логов: `journalctl --vacuum-time=7d`
2. Очистка Docker: `docker system prune -a`
3. Анализ больших файлов: `du -ah / | sort -hr | head -20`
4. Увеличение диска через панель beget.com

## Экономика и ROI

### Текущие затраты

#### Первый сервер:

```
Стоимость: 18,48₽/день = 554₽/месяц = 6 645₽/год
В валюте: ~$74/год (по курсу 90₽/$)
Дата оплаты: Актуальна до конца июля 2025
```

#### Второй сервер:

```
Стоимость: 23,76₽/день = 714₽/месяц = 8 571₽/год
В валюте: ~$95/год (по курсу 90₽/$)
Дата оплаты: Актуальна до конца июля 2025
```

#### Общие затраты:

```
Итого: 42,24₽/день = 1 268₽/месяц = 15 216₽/год
В валюте: ~$169/год
```

### Сравнение с конкурентами

#### beget.com vs другие провайдеры:

-  **Selectel:** Аналогичная конфигурация \~1 500₽/месяц (+62%)
-  **VPS.house:** Аналогичная конфигурация \~1 200₽/месяц (+30%)
-  **DigitalOcean:** $12+20/month = $32/month = \~2 880₽/месяц (+211%)
-  **AWS Lightsail:** $10+20/month = $30/month = \~2 700₽/месяц (+192%)

**Вывод:** beget.com дает экономию 50-150% по сравнению с зарубежными провайдерами

### ROI для стартапа tapbot.kz

#### Бизнес-метрики:

-  **Один проект клиента:** 50 000₽ - 150 000₽
-  **Месячные затраты на серверы:** 1 268₽ - 2 468₽ (при масштабировании)
-  **Окупаемость:** 1 проект покрывает 2-4 года работы серверов
-  **Маржинальность:** 95%+ после покрытия базовых расходов

## Планы масштабирования

### Этап 1: Стабилизация (июль 2025)

```
Статус: Серверы готовы к полной нагрузке
Действия: Завершение установки Redis + Qdrant
Дополнительные затраты: Не требуются
Итого: 1 268₽/месяц (без изменений)
```

### Этап 2: Оптимизация при росте (2026)

```
Триггер: Второй сервер RAM >85% более 24 часов
Действие: Upgrade второго сервера 4GB → 8GB RAM
Стоимость: 714₽ → 1 200₽/месяц (+486₽)
Итого: 1 268₽ → 1 754₽/месяц (+38%)
```

### Этап 3: Горизонтальное масштабирование (2026)

```
Триггер: Оба сервера >80% загрузки постоянно
Действие: Добавление третьего сервера (Load balancer + Redis cluster)
Конфигурация: 2 CPU, 4GB RAM, 30GB SSD
Стоимость: +714₽/месяц
Итого: 1 754₽ → 2 468₽/месяц (+41%)
```

### Этап 4: Enterprise (2027+)

```
Переход на dedicated серверы с гарантированными ресурсами
Географическое распределение (CDN, edge серверы)
Профессиональная поддержка и SLA
Ориентировочно: 5 000₽ - 15 000₽/месяц
```

## Чеклист принятия решений

### ✅ Когда увеличивать RAM:

* [ ] Usage >85% более 24 часов подряд

* [ ] Частые swap операции в `dmesg`

* [ ] Деградация производительности приложений

* [ ] Планируемое добавление новых сервисов (Qdrant)

### ✅ Когда увеличивать CPU:

* [ ] Usage >90% более 1 часа подряд

* [ ] Увеличение времени ответа API >2 секунд

* [ ] Очереди задач в n8n >100 элементов

* [ ] Жалобы пользователей на медленную работу

### ✅ Когда добавлять новый сервер:

* [ ] Оба текущих сервера >80% загрузки постоянно

* [ ] Необходима географическая распределенность

* [ ] Требования безопасности (изоляция критичных данных)

* [ ] Планируемая нагрузка превышает возможности upgrade

---

**Связанные документы:**

-  [03\.01 - Архитектурные принципы](../03-software-stack/03-01-architecture/README) - общая архитектура решения
-  [04\.03 - Управление портами](../04-network-architecture/04-03-port-management/README) - сетевая конфигурация
-  [05\.02 - Безопасность серверов](../05-security/05-02-server-security/README) - защита инфраструктуры
-  [08\.02 - Планы развития инфраструктуры](../08-planning/08-02-infrastructure/README) - стратегические планы

**Важное примечание:** Этот документ содержит полную техническую и экономическую характеристику серверной инфраструктуры проекта. При принятии решений по масштабированию всегда ориентируйтесь на актуальные метрики мониторинга и business requirements стартапа. Обновляйте стоимостные показатели при изменении курсов валют или тарифов провайдера.